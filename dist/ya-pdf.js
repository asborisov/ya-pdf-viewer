!function(){"use strict";angular.module("ya.pdf",[]).constant("ya.pdf.config",{classes:{thumbnails:"__thumbnails",fullScreen:"__full",hidden:"__hidden",container:"ya-pdf-container",thumbnailsContainer:"ya-pdf-thumbnailsContainer",thumbPageNumber:"ya-pdf-thumbnail-pageNumber",pagesContainer:"ya-pdf-pagesContainer",pageContainer:"ya-pdf-pageContainer",textContainer:"ya-pdf-textContainer",outlineContainer:"ya-pdf-outlineContainer",pageNumber:"ya-pdf-pageNumber",toolbar:"ya-pdf-toolbar"},zoomStep:.2,maxAutoZoom:1.25,thumbnailScale:.5,maxDisplayedPage:9})}(),function(){"use strict";function e(){function e(){i={}}function n(e,n){return angular.isString(e)?void t(e,n):void(angular.isObject(e)&&angular.forEach(e,function(e,n){angular.isString(n)&&t(n,e)}))}function t(e,n){angular.isUndefined(i[e])&&(i[e]=[]),i[e].push(n)}function a(e){if(!angular.isUndefined(i[e])){var n=Array.prototype.slice.call(arguments,1);angular.forEach(i[e],function(e){e.apply(this,n)})}}var i={};return{register:n,execute:a,cleanup:e}}angular.module("ya.pdf").factory("ya.pdf.communicationService",e)}(),function(){"use strict";function e(e,n){function t(e,t){return a(),h=v.INITED,e?(f=e,m.getDocument(f).then(function(e){return g=e,h=v.LOADED,p=g.numPages,n.resolve()},function(e){return n.reject(e)})):n.reject("ya.pdf.documentService: No url passed")}function a(){g&&g.cleanup(),g=null,f=null,p=null,h=v.UNKNOWN}function i(){return p||0}function r(){return f}function u(e){return function(){return h!=v.LOADED?n.reject("Document is not loaded"):e.apply(this,arguments)}}function o(e,n){return c(e).then(function(e){return e.getViewport(n)})}function c(e){return g.getPage(e)}function l(e){return g.getDestination(e)}function s(){return g.getOutline()}function d(e){return g.getPageIndex(e)}if(!e.PDFJS)throw"PDFJS is not defined";var g,f,p,h,m=e.PDFJS,v={UNKNOWN:0,INITED:1,LOADED:2};return{initialize:t,cleanup:a,getPagesCount:i,getUrl:r,getPageData:u(c),getPageViewport:u(o),getDestination:u(l),getOutline:u(s),getPageIndex:u(d)}}angular.module("ya.pdf").factory("ya.pdf.documentService",e),e.$inject=["$window","$q"]}(),function(){"use strict";function e(e,n,t){function a(){return i(),r()}function i(){l=[],s=null}function r(){return s?e.resolve(s):o()}function u(n){var a;a=angular.isString(n)?t.getDestination(n):e.resolve(n),a.then(function(e){angular.isArray(e)&&c(e,e[0])})}function o(){function n(e){return{dest:e.dest||"",title:e.title||"",items:e.items.map(n)}}return t.getOutline().then(function(t){return t?(s=t.map(n)||[],e.resolve(s)):e.resolve([])})}function c(e,a){var i=angular.isObject(a)?l[a.num+" "+a.gen+" R"]:a+1;i?(i>t.getPagesCount()&&(i=t.getPagesCount()),n.execute("onScrollToPage",i,e)):t.getPageIndex(a).then(function(n){var t=a.num+" "+a.gen+" R";l[t]=n+1,c(e,a)})}var l,s;return{initialize:a,cleanup:i,getOutline:r,navigateTo:u}}angular.module("ya.pdf").factory("ya.pdf.outlineService",e),e.$inject=["$q","ya.pdf.communicationService","ya.pdf.documentService"]}(),function(){"use strict";function e(e,n,t){function a(){l=[]}function i(e){a(),d=e}function r(a){var i=o(a);i.forEach(function(e){s.indexOf(e)<0&&s.push(e),l.indexOf(e)<0&&l.push(e)}),n.execute("onPageNeedRender",i);for(var r=[],u=0;l.length>t.maxDisplayedPage;)i.indexOf(l[u])<0?r.push(l.splice(u,1)[0]):u++;return n.execute("onPageNeedDelete",r),e.resolve({toRender:i,toDelete:r})}function u(){var n=s;return s=[],e.resolve(n)}function o(e){for(var n=[],t=e-4;e+4>=t;t++)t>0&&d>=t&&n.push(t);return n}function c(){return l}var l=[],s=[],d=0;return{initialize:i,cleanup:a,setPage:r,getRenderedPages:c,pagesToClean:u}}angular.module("ya.pdf").factory("ya.pdf.renderQueueService",e),e.$inject=["$q","ya.pdf.communicationService","ya.pdf.config"]}(),function(){"use strict";function e(e,n,t,a){function i(){r(),l(0)}function r(){P=[],C=[],x={page:0,itemId:0,idx:-1,number:0}}function u(e,n){return b&&C[e]&&C[e][n]?{searchText:b,matches:C[e][n],selected:x}:null}function o(e){return t.getPageData(e).then(function(e){n.execute("onRenderTextLayer",e)})}function c(){return n.execute("onClearTextLayer"),a.getRenderedPages().forEach(function(e){return o(e)})}function l(e){return t.getPageData(e+1).then(function(n){return n.getTextContent(e).then(function(n){for(var a=n.items,i=[],r=0,u=a.length;u>r;r++)i.push(a[r].str);return P[e]=i,e+1<t.getPagesCount()?l(e+1):void 0})})}function s(){x={page:0,itemId:0,idx:-1,number:0},S=x,C=[],T=0,angular.forEach(P,function(e){var n=[];angular.forEach(e,function(e){for(var t=[],a=0;;){if(a=e.toLowerCase().indexOf(b,a+1),-1==a)break;t.push(a),T++}n.push(t)}),C.push(n)}),c(),g()}function d(e){if(!e)return!0;for(var n=!0,t=0;n&&!angular.isUndefined(e[t]);)n=!e[t++].length;return n}function g(){if(!b)return e.resolve();if(1==T&&1==x.number)return e.resolve();if(S.idx++,C[S.page]&&void 0!=C[S.page][S.itemId]&&void 0!=C[S.page][S.itemId][S.idx]){x=S;var i=document.querySelectorAll("span.highlight.selected");return i.length&&(i[0].className="highlight"),-1==a.getRenderedPages().indexOf(x.page+1)?(n.execute("onSetPage",x.page+1),o(x.page+1),h(1),e.resolve()):o(x.page+1).then(function(){h(1)})}if(S.itemId++,S.idx=-1,C[S.page]&&void 0!=C[S.page][S.itemId])return g();for(S.page++;d(C[S.page]);){if(S.page>=t.getPagesCount())return e.resolve();S.page++}return S.itemId=0,g()}function f(){return S=angular.copy(x),p()}function p(){if(!b)return e.resolve();if(1==T&&1==x.number)return e.resolve();if(S.idx--,S.idx>=0){x=S;var t=document.querySelectorAll("span.highlight.selected")[0];return t&&(t.className="highlight"),-1==a.getRenderedPages().indexOf(x.page+1)?(n.execute("onSetPage",x.page+1),o(x.page+1),h(-1),e.resolve()):o(x.page+1).then(function(){h(-1)})}if(S.itemId--,C[S.page]&&void 0!==C[S.page][S.itemId])return S.idx=C[S.page][S.itemId].length,p();for(S.page--;d(C[S.page]);){if(S.page<0)return e.resolve();S.page--}return S.itemId=C[S.page].length,p()}function h(e){return x||(x={number:0}),x.number||(x.number=0),e&&x.number+e<=T&&x.number+e>=0&&(x.number+=e),x.number}function m(){b="",C=[],c()}function v(e){return e?void(e!=b?(b=e.toLowerCase(),s()):(S=angular.copy(x),g())):void m()}function y(){return T||0}var P,b,C,x,S,T;return{initialize:i,cleanup:r,getMatchData:u,find:v,findPrev:f,currentNumber:h,foundCount:y}}angular.module("ya.pdf").factory("ya.pdf.textLayerService",e),e.$inject=["$q","ya.pdf.communicationService","ya.pdf.documentService","ya.pdf.renderQueueService"]}(),function(){"use strict";function e(e,n,t){function a(){u={}}function i(n){var t=n-1;return u[t]?e.resolve(u[t]):r(t)}function r(e){return n.getPageData(e+1).then(function(n){var a=angular.element("<canvas></canvas>")[0],i=a.getContext("2d"),r=n.getViewport(t.thumbnailScale);a.height=r.height,a.width=r.width;var o={canvasContext:i,viewport:r};return n.render(o).promise.then(function(){return u[e]=a.toDataURL(),u[e]})})}var u;return{initialize:a,cleanup:a,getThumbnail:i}}angular.module("ya.pdf").factory("ya.pdf.thumbnailService",e),e.$inject=["$q","ya.pdf.documentService","ya.pdf.config"]}(),function(){"use strict";function e(e,n,t,a,i,r,u,o,c){function l(e){angular.isUndefined(e.scale)||(x=e.scale),angular.isUndefined(e.page)||(S=e.page)}function s(e){return d(),e&&l(e),a.register("onSetPage",m),n.resolve()}function d(){i.cleanup(),r.cleanup(),c.cleanup(),o.cleanup(),u.cleanup(),x=1,S=0,T=!1}function g(){return S}function f(){a.execute("onLoadProgress",arguments)}function p(e){return e?i.initialize(e,f).then(function(){return r.initialize(i.getPagesCount()),u.initialize(),o.initialize(),c.initialize().then(function(e){a.execute("onOutlineDisabled",!e.length)}),a.execute("onDocumentLoaded"),n.resolve()},function(e){return a.execute("onDocumentError",e),n.reject(e)}):n.reject("ya.pdf.viewerService_open: No url passed")}function h(e){e=e||1;for(var t=[],r=1;r<=i.getPagesCount();r++)t.push(i.getPageData(r).then(function(n){a.execute("onSetPageSize",n.pageNumber,n.getViewport(e))}));return n.all(t)}function m(e){return r.setPage(e),e!=S&&(S=e,a.execute("onPageChanged",e)),n.resolve(S)}function v(e){return i.getPageViewport(e,x)}function y(e){w=e}function P(e,t){if(e==x)return n.resolve(x);if(t){var i=(t.width-5)/w.width*x,u=(t.height-5)/w.height*x;switch(e){case"actual":e=1;break;case"width":e=i;break;case"height":e=u;break;case"fit":e=Math.min(i,u);break;case"auto":var o=w.width>w.height,c=o?Math.min(u,i):i;e=Math.min(config.maxAutoZoom,c)}}return x=e,r.pagesToClean().then(function(e){return a.execute("onPageNeedDelete",e,!0),n.all([m(S),h(x)]).then(function(){return x})})}function b(){T=!T,a.execute("onThumbnailsToggled",T)}function C(e){var n=i.getUrl();e&&(n+=e);var a=angular.element("#yaPdfDownloadLink"),r=angular.element(a);r.attr({target:"_self",href:n}),t(function(){try{r[0].click()}catch(e){}},0,!1)}if(!e.PDFJS)throw"PDFJS is not defined";var x,S,T,w=(e.PDFJS,{});return{initialize:s,cleanup:d,open:p,setPage:m,getPageNumber:g,setScale:P,setLastPageSize:y,toggleThumbnails:b,downloadDocument:C,preparePageSize:h,getPageViewport:v,getPage:i.getPageData,getPagesCount:i.getPagesCount,getMatchData:u.getMatchData,findText:u.find,findPrev:u.findPrev,currentSelected:u.currentNumber,foundCount:u.foundCount,getPageThumbnail:o.getThumbnail,getOutline:c.getOutline,navigateTo:c.navigateTo,set documentScale(e){P(e)},get documentScale(){return x}}}angular.module("ya.pdf").factory("ya.pdf.viewerService",e),e.$inject=["$window","$q","$timeout","ya.pdf.communicationService","ya.pdf.documentService","ya.pdf.renderQueueService","ya.pdf.textLayerService","ya.pdf.thumbnailService","ya.pdf.outlineService"]}(),function(){"use strict";function e(e){e.put("yaPdfOutlineItem",'<div ng-click="navigateTo(line.dest)" >{{line.title}}</div><ul ng-if="line.items && line.items.length"><li ng-repeat="line in line.items" ng-include="\'yaPdfOutlineItem\'"></ul>'),e.put("yaPdfOutlineTemplate.html",'<div><ul><li ng-repeat="line in outline" ng-include="\'yaPdfOutlineItem\'"></li></ul></div>')}function n(e,n,t){return{restrict:"E",replace:!0,templateUrl:function(e,n){return n.templateUrl||"yaPdfOutlineTemplate.html"},link:function(a,i){function r(){a.disabled=!0,e.register({onDocumentLoaded:u})}function u(){n.getOutline().then(function(e){e&&e.length?a.outline=e:(angular.element(i).addClass(t.classes.hidden),a.outline=[])})}a.navigateTo=n.navigateTo,a.disabled,r()}}}angular.module("ya.pdf").run(["$templateCache",e]).directive("yaPdfOutline",n),n.$inject=["ya.pdf.communicationService","ya.pdf.viewerService","ya.pdf.config"]}(),function(){"use strict";function e(e,n){return{restrict:"A",require:"ngModel",link:function(t,a,i,r){function u(n){r.$setViewValue(n),e(i.ngModel).assign(t,n),r.$render()}n.register({onPageChanged:u})}}}angular.module("ya.pdf").directive("yaPdfPageNumber",e),e.$inject=["$parse","ya.pdf.communicationService"]}(),function(){"use strict";function e(e){e.put("yaPdfToolbarTemplate.html",'<div class="{{::classes.toolbar}}">   <div class="btn-group">       <i class="fa fa-arrow-left fa-lg" ng-click="prev()"></i>       <i class="fa fa-arrow-right fa-lg" ng-click="next()"></i>       <i class="fa fa-search-minus fa-lg" ng-click="zoomOut()"></i>       <i class="fa fa-search-plus fa-lg" ng-click="zoomIn()"></i>   </div>   <div class="btn-group">       <input type="text" class="form-control pdf-current-page" min=1 ng-model="currentPage"        ng-change="goToPage()" ya-pdf-page-number=""  ng-model-options="{updateOn: \'keypress\'}"> / {{pagesCountValue}}   </div>   <div class="btn-group">       <div ng-click="toggleOutline()">           <i class="fa fa-list fa-lg"></i>       </div>   </div>   <div class="btn-group search-group" ng-init="focused = false">       <div class="search-field" ng-class="{\'search-field-focused\': focused, \'search-field-found\': searchText.length}">         <form ng-submit="find(searchText)">           <div class="search-counter">{{ currentSelected() }} / {{ foundCount() }}</div>           <input type="text" required="required" ng-model="searchText" placeholder=""                  ng-focus="focused = true"                  ng-blur="focused = false"                  ng-change="find(searchText)"                  ng-model-options="{ debounce: 500 }">           <div class="search-prev" ng-click="findPrev()">               <i class="fa fa-chevron-up"></i>           </div>           <div class="search-next" ng-click="find(searchText)">               <i class="fa fa-chevron-down"></i>           </div>       </form>      </div>   </div></div>')}function n(e,n,t){return{restrict:"E",templateUrl:function(e,n){return n.templateUrl||"yaPdfToolbarTemplate.html"},link:function(a,i){function r(){b=!1,a.isOutlineDisabled=!1,e.register({onDocumentLoaded:u,onOutlineDisabled:c,onThumbnailsToggled:v})}function u(){P=angular.element("."+t.classes.container),a.pagesCountValue=n.getPagesCount()}function o(){b=!b,b?i.addClass(t.classes.fullScreen):i.removeClass(t.classes.fullScreen),e.execute("onFullScreenToggled",b)}function c(e){a.isOutlineDisabled=e}function l(){a.isOutlineDisabled||(C=!C,e.execute("onOutlineToggled",C))}function s(){a.currentPage>1&&(a.currentPage--,f(a.currentPage))}function d(){a.currentPage&&a.currentPage<a.pagesCountValue&&(a.currentPage++,f(a.currentPage))}function g(){f(a.currentPage)}function f(t){if(t&&parseInt(t)&&t<=a.pagesCountValue&&t>0){var i=parseInt(t);n.setPage(i).then(function(n){e.execute("onScrollToPage",n)})}}function p(){return a.currentPage}function h(){var e=parseFloat(a.scale.value)+t.zoomStep;y(e)}function m(){var e=parseFloat(a.scale.value)-t.zoomStep;y(e)}function v(e){e?i.addClass(t.classes.thumbnails):i.removeClass(t.classes.thumbnails)}function y(e){var t=a.currentPage;e?e.name&&e.value&&(e=e.value):e=a.scale.value;var i=parseFloat(e);if(isNaN(i))i=e;else if(0>=i||i>5)return;n.setScale(i,{width:P[0].clientWidth,height:P[0].clientHeight}).then(function(e){a.scale={name:(100*e).toFixed()+"%",value:e},f(t)})}var P,b=!1,C=!1;a.classes=t.classes,a.currentPage=1,a.scale={name:"100%",value:1},a.pagesCountValue=0,a.searchText="",a.prev=s,a.next=d,a.zoomIn=h,a.zoomOut=m,a.setScale=y,a.goToPage=g,a.toggleFullScreen=o,a.toggleThumbnails=n.toggleThumbnails,a.toggleOutline=l,a.isOutlineDisabled=!1,a.downloadDocument=n.downloadDocument,a.find=n.findText,a.findPrev=n.findPrev,a.currentSelected=n.currentSelected,a.foundCount=n.foundCount,a.getCurrentPage=p,r()}}}angular.module("ya.pdf").run(["$templateCache",e]).directive("yaPdfToolbar",n),n.$inject=["ya.pdf.communicationService","ya.pdf.viewerService","ya.pdf.config"]}(),function(){"use strict";function e(e){e.put("yaPdfPage",'<div class="{{::classes.pageContainer}}" id="ya-pdf-page-{{::page}}" page-number="{{::page}}" >   <canvas></canvas>   <div class="{{::classes.textContainer}}"></div></div><div class="{{::classes.pageNumber}}">Страница {{::page}}</div>'),e.put("yaPdfThumbnailItem",'<img id="ya-pdf-thumbnail-{{::page}}" page-number="{{::page}}" ng-click="thumbnailClick(page)"><div class="{{::classes.thumbPageNumber}}">{{::page}}</div>'),e.put("yaPdfViewer.html",'<div class="{{::classes.container}}">   <ya-pdf-outline class="{{::classes.outlineContainer}} __hidden"></ya-pdf-outline>   <div class="{{::classes.pagesContainer}}">       <div ng-repeat="page in pages" ng-include="\'yaPdfPage\'"></div>   </div>   <div class="{{::classes.thumbnailsContainer}}">       <div ng-repeat="page in pages" ng-include="\'yaPdfThumbnailItem\'"></div>   </div></div><a ng-hide="true" id="yaPdfDownloadLink"></a>')}function n(e,n,t,a,i){return{restrict:"E",templateUrl:function(e,n){return n.templateUrl||"yaPdfViewer.html"},scope:{yaPdfUrl:"@"},link:function(r,u,o){function c(){I&&I.unbind("scroll",d),t.cleanup(),a.cleanup(),N=null,r.pagesCount=0,r.pages=[]}function l(){r.pagesCount=0,r.pages=[],t.register({onPageNeedRender:b,onPageNeedDelete:y,onRenderTextLayer:x,onClearTextLayer:S,onFullScreenToggled:T,onThumbnailsToggled:w,onOutlineToggled:D,onSetPageSize:v,onScrollToPage:h,onScrollToDiv:m}),a.initialize().then(function(){a.open(r.yaPdfUrl).then(function(){r.pagesCount=a.getPagesCount();for(var e=1;e<=r.pagesCount;e++)r.pages.push(e);r.outline=a.outline,n(function(){I=angular.element("."+i.classes.container),I.bind("scroll",d),a.setPage(1).then(a.preparePageSize).then(function(){t.execute("onViewerLoaded")})})})})}function s(e){a.toggleThumbnails(),a.setPage(e).then(h)}function d(){N||(N=n(function(){I.hasClass(i.classes.thumbnails)?g():f(),N=null},500))}function g(){for(var e=angular.element("."+i.classes.thumbnailsContainer+' > div > img:not([thumbnail-rendered="true"])'),n=I[0].scrollTop+I[0].clientHeight,t=0;t<e.length&&e[t].offsetTop<n;t++){var a=e[t].attributes["page-number"].value;O(parseInt(a))}}function f(){for(var e=angular.element("."+i.classes.pageContainer),n=I[0].scrollTop+I[0].clientHeight,t=I[0].scrollTop+I[0].clientHeight/2,u=0;u<r.pagesCount&&e[u].offsetTop<n;u++)if(e[u].offsetTop<t&&e[u].offsetTop+e[u].offsetHeight>t){var o=e[u].attributes["page-number"].value;return void a.setPage(parseInt(o))}}function p(e,n){if(e){var t=I[0],a=e.offsetTop;n?a+=angular.isUndefined(n.top)?0:n.top/2:a-=(t.clientHeight-e.clientHeight)/2,t.scrollTop=a}}function h(e,n){var t=96/72,i=angular.element("#ya-pdf-page-"+e)[0];return n?void a.getPageViewport(e).then(function(e){var r,u,o=0,c=0,l=0,s=0,d=i.rotation%180!==0,g=(d?e.height:e.width)/e.scale/t,f=(d?e.width:e.height)/e.scale/t,h=0;switch(n[1].name){case"XYZ":o=n[2],c=n[3],h=n[4],o=null!==o?o:0,c=null!==c?c:f;break;case"Fit":case"FitB":h="fit";break;case"FitH":case"FitBH":c=n[2],h="width";break;case"FitV":case"FitBV":o=n[2],l=g,s=f,h="height";break;case"FitR":o=n[2],c=n[3],l=n[4]-o,s=n[5]-c,r=I[0].clientWidth/l/t,u=I[0].clientHeight/s/t,h=Math.min(Math.abs(r),Math.abs(u));break;default:return}if(h&&h!==a.documentScale?a.documentScale=h:0===a.documentScale&&(a.documentScale="actual"),"fit"===h&&!n[4])return void p(i);var m=[e.convertToViewportPoint(o,c),e.convertToViewportPoint(o+l,c+s)],v=Math.min(m[0][0],m[1][0]),y=Math.min(m[0][1],m[1][1]);p(i,{left:v,top:y})}):void p(i)}function m(e){e.scrollIntoView(),I[0].scrollTop-=I[0].clientHeight/2}function v(e,n){var t=angular.element("#ya-pdf-page-"+e);t.css("width",n.width),t.css("height",n.height)}function y(e,n){return angular.isArray(e)?void angular.forEach(e,function(e){P(e,n)}):P(e,n)}function P(e,n){var t=angular.element("#ya-pdf-page-"+e);if(t.addClass(i.classes.hidden),n){t.attr("page-rendered",!1);var a=angular.element("#ya-pdf-page-"+e+" ."+i.classes.textContainer);a.attr("rendered",!1)}}function b(e){return angular.isArray(e)?void angular.forEach(e,function(e){C(e)}):C(e)}function C(e){a.getPage(e).then(function(n){var t=angular.element("#ya-pdf-page-"+e),r=angular.element("#ya-pdf-page-"+e+" canvas")[0];if("true"==t.attr("page-rendered"))t.removeClass(i.classes.hidden);else{t.attr("page-rendered",!0);var u=r.getContext("2d");u.clearRect(0,0,r.width,r.height);var o=n.getViewport(a.documentScale);r.height=o.height,r.width=o.width,a.setLastPageSize({width:o.width,height:o.height});var c={canvasContext:u,viewport:o};n.render(c)}var l=angular.element("#ya-pdf-page-"+e+" ."+i.classes.textContainer);"true"!=l.attr("rendered")&&(x(n),l.attr("rendered",!0))})}function x(n){var r=angular.element("#ya-pdf-page-"+(n.pageIndex+1)+" ."+i.classes.textContainer),u=angular.element("#ya-pdf-page-"+(n.pageIndex+1)+" canvas")[0];n.getTextContent().then(function(i){for(;r[0].firstChild;)r[0].removeChild(r[0].firstChild);var o,c,l=u.getContext("2d"),s=n.getViewport(a.documentScale);i.items.forEach(function(u,d){if(/\S/.test(u.str)){var g=i.styles[u.fontName],f=angular.element("<div></div>")[0],p=e.PDFJS.Util.transform(s.transform,u.transform),h=Math.atan2(p[1],p[0]);g.vertical&&(h+=Math.PI/2);var m=Math.sqrt(p[2]*p[2]+p[3]*p[3]),v=m;g.ascent?v=g.ascent*v:g.descent&&(v=(1+g.descent)*v);var y,P;0===h?(y=p[4],P=p[5]-v):(y=p[4]+v*Math.sin(h),P=p[5]-v*Math.cos(h));var b=m+"px",C=g.fontFamily;f.style.left=y+"px",f.style.top=P+"px",f.style.fontSize=b,f.style.fontFamily=C,f.textContent=u.str,0!==h&&(f.dataset.angle=h*(180/Math.PI)),u.str.length>1&&(g.vertical?f.dataset.canvasWidth=u.height*a.documentScale:f.dataset.canvasWidth=u.width*a.documentScale),b===o&&C===c||(l.font=b+" "+C,o=b,c=C);var x=l.measureText(f.textContent).width;if(x>0){r[0].appendChild(f);var S;if(void 0!==f.dataset.canvasWidth){var T=f.dataset.canvasWidth/x;S="scaleX("+T+")"}else S="";var w=f.dataset.angle;w&&(S="rotate("+w+"deg) "+S),S&&(f.style.transform=S)}var D=a.getMatchData(n.pageIndex,d);if(D){var O=D.matches,I=D.selected;f.textContent="";for(var N=0,k=0;;){var $=u.str.substring(N,O[k]),z=document.createTextNode($);if(f.appendChild(z),void 0===O[k])break;var V=I.page==n.pageIndex&&I.itemId==d&&I.idx==k,F=u.str.substring(O[k],O[k]+D.searchText.length),j=document.createTextNode(F),L=document.createElement("span");L.className="highlight"+(V?" selected":""),L.appendChild(j),f.appendChild(L),V&&t.execute("onScrollToDiv",f),N=O[k]+D.searchText.length,k++}}}}),r.attr("rendered",!0)})}function S(){var e=angular.element(i.classes.textContainer);e.attr("text-rendered",!1)}function T(e){e?I.addClass(i.classes.fullScreen):I.removeClass(i.classes.fullScreen)}function w(e){e?(I.addClass(i.classes.thumbnails),g()):(I.removeClass(i.classes.thumbnails),f())}function D(e){var n=angular.element("."+i.classes.outlineContainer);e?n.removeClass(i.classes.hidden):n.addClass(i.classes.hidden)}function O(e){return a.getPageThumbnail(e).then(function(n){var t=angular.element("#ya-pdf-thumbnail-"+e);t.length&&(t[0].src=n,t.attr("thumbnail-rendered",!0))})}var I,N=null;r.pagesCount,r.pages,r.classes=i.classes,r.thumbnailClick=s,o.$observe("yaPdfUrl",function(e){e&&l()}),r.$on("$destroy",c)}}}angular.module("ya.pdf").run(["$templateCache",e]).directive("yaPdfViewer",n),n.$inject=["$window","$timeout","ya.pdf.communicationService","ya.pdf.viewerService","ya.pdf.config"]}();